name: Basic Project Diagnostics

on:
  push:
  pull_request:
  workflow_dispatch:

jobs:
  diagnostics:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository (no LFS)
        uses: actions/checkout@v4
        with:
          lfs: false

      - name: Check Unity project structure
        run: |
          echo "Checking Unity project structure..."
          if [ -d "Assets" ]; then 
            echo "✔ Assets folder found."
          else
            echo "❌ Assets folder missing!"
          fi

          if [ -d "ProjectSettings" ]; then 
            echo "✔ ProjectSettings folder found."
          else
            echo "❌ ProjectSettings folder missing!"
          fi

      - name: Check for unwanted Unity folders in repo
        run: |
          echo "Checking unwanted folders..."
          [ -d "Library" ] && echo "⚠️ Library folder is committed (should be ignored)"
          [ -d "Temp" ] && echo "⚠️ Temp folder is committed (should be ignored)"
          [ -d "Logs" ] && echo "⚠️ Logs folder is committed (should be ignored)"

      - name: Check .gitignore for Unity rules
        run: |
          echo "Checking .gitignore..."
          if [ -f ".gitignore" ]; then
            grep -q "Library/" .gitignore || echo "⚠️ .gitignore is missing: Library/"
            grep -q "Temp/" .gitignore || echo "⚠️ .gitignore is missing: Temp/"
            grep -q "Logs/" .gitignore || echo "⚠️ .gitignore is missing: Logs/"
          else
            echo "⚠️ No .gitignore found!"
          fi

      - name: Output Git Status
        run: |
          echo "Git status:"
          git status --short
